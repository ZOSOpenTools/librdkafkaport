diff --git a/src/rdkafka_offset.c b/src/rdkafka_offset.c
index 701a4161..978eaf13 100644
--- a/src/rdkafka_offset.c
+++ b/src/rdkafka_offset.c
@@ -71,13 +71,34 @@
  * Convert an absolute or logical offset to string.
  */
 const char *rd_kafka_offset2str(int64_t offset) {
+#ifdef __MVS__
+        static pthread_key_t ret_key;
+        static pthread_key_t reti_key;
+        static int ret_key_s = 0;
+        static int reti_key_s = 0;
+        char **ret = NULL;
+        int *reti_p = NULL;
+        size_t size_of_ret = 32;
+        GET_KEY_VAL_ARRAY(ret_key,ret_key_s,ret,sizeof(char),16,32)
+        GET_KEY_VAL(reti_key,reti_key_s,reti_p,sizeof(int))
+//#define reti (*reti_p)
+#else
         static RD_TLS char ret[16][32];
         static RD_TLS int i = 0;
+#endif
 
+#ifdef __MVS__
+        (*reti_p) = ((*reti_p) + 1) % 16;
+#else
         i = (i + 1) % 16;
+#endif
 
         if (offset >= 0)
+#ifdef __MVS__
+                rd_snprintf(ret[(*reti_p)], size_of_ret, "%" PRId64, offset);
+#else
                 rd_snprintf(ret[i], sizeof(ret[i]), "%" PRId64, offset);
+#endif
         else if (offset == RD_KAFKA_OFFSET_BEGINNING)
                 return "BEGINNING";
         else if (offset == RD_KAFKA_OFFSET_END)
@@ -87,12 +108,25 @@ const char *rd_kafka_offset2str(int64_t offset) {
         else if (offset == RD_KAFKA_OFFSET_INVALID)
                 return "INVALID";
         else if (offset <= RD_KAFKA_OFFSET_TAIL_BASE)
+#ifdef __MVS__
+                rd_snprintf(ret[(*reti_p)], size_of_ret, "TAIL(%lld)",
+#else
                 rd_snprintf(ret[i], sizeof(ret[i]), "TAIL(%lld)",
+#endif
                             llabs(offset - RD_KAFKA_OFFSET_TAIL_BASE));
         else
+#ifdef __MVS__
+                rd_snprintf(ret[(*reti_p)], size_of_ret, "%" PRId64 "?", offset);
+#else
                 rd_snprintf(ret[i], sizeof(ret[i]), "%" PRId64 "?", offset);
-
+#endif
+#ifdef __MVS__
+       SET_KEY_VAL(reti_key,reti_p)
+       SET_KEY_VAL(ret_key,ret)
+        return ret[(*reti_p)];
+#else
         return ret[i];
+#endif
 }
 
 static void rd_kafka_offset_file_close(rd_kafka_toppar_t *rktp) {
